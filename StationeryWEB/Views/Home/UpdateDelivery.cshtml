@model StationeryAPI.ShoppingModels.UpdateDelivery

@{
    ViewData["Title"] = "Update Delivery";
}

<h2>Update Delivery</h2>

<form id="updatedeliveryForm">
    <div>
        <label for="deliveryId">Delivery ID:</label>
        <input type="text" id="deliveryId" name="deliveryId" required>
    </div>
    <div>
        <label for="orderId">Order Id:</label>
        <input type="text" id="orderId" name="orderId" required>
    </div>
    <div>
        <label for="deliveryDate">Delivery Date:</label>
        <input type="date" id="deliveryDate" name="deliveryDate" required>
    </div>
    <div>
        <label for="deliveryStatus">Delivery Status:</label>
        <input type="text" id="deliveryStatus" name="deliveryStatus" required>
    </div>
    <div>
        <label for="deliveryFee">Delivery Fee:</label>
        <input type="number" id="deliveryFee" name="deliveryFee" required step="0.01">
    </div>
    <div>
        <label for="carrierName">Carrier Name:</label>
        <input type="text" id="carrierName" name="carrierName" required>
    </div>

    <button type="submit">Update Delivery</button>
</form>

<div id="deliveryResult"></div>

@section Scripts {
    <script>
        document.getElementById('updatedeliveryForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent the default form submission

            // Gather form data into an order object
            var delivery = {
                deliveryId: document.getElementById('deliveryId').value,
                orderId: document.getElementById('orderId').value,
                deliveryDate: document.getElementById('deliveryDate').value,
                deliveryStatus: document.getElementById('deliveryStatus').value,
                deliveryFee: parseFloat(document.getElementById('deliveryFee').value),
                carrierName: document.getElementById('carrierName').value,
               
            };

            try {
                const response = await fetch('https://localhost:7106/api/Customer/UpdateDelivery', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(delivery)
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Failed to update delivery:', errorData);
                    document.getElementById('deliveryResult').textContent = 'Failed to create order: ' + JSON.stringify(errorData);
                } else {
                    const returndelivery = await response.json();
                    console.log('Delivery updated:', returndelivery);

                    // Here is where you place the code to update the 'orderResult' div
                    document.getElementById('deliveryResult').innerHTML = `
                                                                        <h3>Delivery Updated Successfully!</h3>
                                                                        <div><strong>Order ID:</strong> ${returndelivery.deliveryId}</div>
                                                                        <div><strong>Product ID:</strong> ${returndelivery.orderId}</div>
                                                                        <div><strong>Customer ID:</strong> ${returndelivery.deliveryDate}</div>
                                                                        <div><strong>Total Price:</strong> ${returndelivery.deliveryStatus}</div>
                                                                        <div><strong>Order Status:</strong> ${returndelivery.deliveryFee}</div>
                                                                        <div><strong>Payment Status:</strong> ${returndelivery.carrierName}</div>
                                                                        <!-- Display other properties as needed -->
                                                                    `;
                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('deliveryResult').textContent = 'An error occurred while sending the order.';
            }
        });
    </script>
}


