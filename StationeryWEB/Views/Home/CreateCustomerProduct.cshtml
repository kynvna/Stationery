@model StationeryAPI.ShoppingModels.NewCustomerProduct

@{
    ViewData["Title"] = "Create CustomerProduct";
    var product = TempData["NewCustomerProduct"] as StationeryAPI.ShoppingModels.NewCustomerProduct;
}

<h2>Create CustomerProduct</h2>

<form id="customerproductForm">
    <div>
        <label for="Address">Customer Address:</label>
        <input type="text" id="Address" name="Address" value="@product?.Address" required>
    </div>
    <div>
        <label for="ProId">Product ID:</label>
        <input type="text" id="ProId" name="ProId" value="@product?.ProId" required>
    </div>
    <div>
        <label for="Price">Price:</label>
        <input type="number" id="Price" name="Price" value="@product?.Price" required step="0.01">
    </div>
    <div>
        <label for="Fullname">Full Name:</label>
        <input type="text" id="Fullname" name="Fullname" value="@product?.Fullname" required>
    </div>
    <div>
        <label for="Tel">Telephone:</label>
        <input type="text" id="Tel" name="Tel" value="@product?.Tel" required>
    </div>
    <button type="submit">Submit Customer Product</button>
</form>

<div id="customerproductResult"></div>

@section Scripts {
    <script>
        document.getElementById('customerproductForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent the default form submission

            var customerproduct = {
                 // Changed from customerId to CustId
                ProId: document.getElementById('ProId').value, // Changed from productId to ProId
                Price: parseFloat(document.getElementById('Price').value),
               
                Address:document.getElementById('Address').value,
                FullName:document.getElementById('Fullname').value,
                Tel:document.getElementById('Tel').value,

            };

            try {
                console.log('Form data being sent:', customerproduct);

                const response = await fetch('https://localhost:7106/api/Customer/CreateCustomerProduct', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(customerproduct)
                            

                });
                console.log('Response status:', response.status);
                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('Failed to create customerproduct:', errorData);
                    document.getElementById('customerproductResult').textContent = 'Failed to create customerproduct: ' + JSON.stringify(errorData);
                } else {
                    // Inside your fetch's 'else' block
                    const createdCustomerProduct = await response.json();
                    console.log('CustomerProduct created:', createdCustomerProduct);
                    document.getElementById('customerproductResult').innerHTML = `
            <h3>CustomerProduct Created Successfully!</h3>
            <div><strong>Customer ID:</strong> ${createdCustomerProduct.customerId}</div>
            <div><strong>Product ID:</strong> ${createdCustomerProduct.productId || 'N/A'}</div>
            <div><strong>Price:</strong> ${createdCustomerProduct.price ? createdCustomerProduct.price.toFixed(2) : 'N/A'}</div>
            <div><strong>Status:</strong> ${createdCustomerProduct.status || 'N/A'}</div>
        `;

                }
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('customerproductResult').textContent = 'An error occurred while sending the customerproduct.';
            }
        });


    </script>
}


